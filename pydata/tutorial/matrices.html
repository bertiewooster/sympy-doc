
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Matrices &#8212; SymPy 1.11.dev documentation</title>
    
    <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
  
    
    <link rel="stylesheet"
      href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
    <link rel="preload" as="font" type="font/woff2" crossorigin
      href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">
  
    
      
  
    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/pydata-sphinx-theme.css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">
  
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]]}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/sympy-notailtext-favicon.ico"/>
    <link href="https://docs.sympy.org/latest/tutorial/matrices.html" rel="canonical" />
    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Advanced Expression Manipulation" href="manipulation.html" />
    <link rel="prev" title="Solvers" href="solvers.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    
    <nav class="navbar navbar-light navbar-expand-lg bg-light fixed-top bd-navbar" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="../index.html">
  <img src="../_static/sympylogo.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class="col-lg-9 collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
    <li class="toctree-l1 current active nav-item">
 <a class="reference internal nav-link" href="index.html">
  SymPy Tutorial
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../guides/index.html">
  SymPy Guides
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../explanation/index.html">
  Explanation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../reference/index.html">
  Reference Documentation
 </a>
</li>

<li class="toctree-l1 nav-item">
 <a class="reference internal nav-link" href="../miscellaneous/index.html">
  Miscellaneous
 </a>
</li>

    
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    

    <div class="container-xl">
      <div class="row">
          
            
            <!-- Only show if we have sidebars configured, else just a small margin  -->
            <div class="col-12 col-md-3 bd-sidebar">
              <div class="sidebar-start-items"><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  <div class="bd-toc-item active">
    <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="preliminaries.html">
   Preliminaries
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gotchas.html">
   Gotchas
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="features.html">
   SymPy Features
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="basic_operations.html">
     Basic Operations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="printing.html">
     Printing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="simplification.html">
     Simplification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="calculus.html">
     Calculus
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="solvers.html">
     Solvers
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Matrices
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="manipulation.html">
     Advanced Expression Manipulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="next.html">
   What’s Next
  </a>
 </li>
</ul>

  </div>
</nav>
              </div>
              <div class="sidebar-end-items">
              </div>
            </div>
            
          

          
          <div class="d-none d-xl-block col-xl-2 bd-toc">
            
              
              <div class="toc-item">
                
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-operations">
   Basic Operations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#shape">
     Shape
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#accessing-rows-and-columns">
     Accessing Rows and Columns
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#deleting-and-inserting-rows-and-columns">
     Deleting and Inserting Rows and Columns
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basic-methods">
   Basic Methods
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-constructors">
   Matrix Constructors
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#advanced-methods">
   Advanced Methods
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#determinant">
     Determinant
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rref">
     RREF
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nullspace">
     Nullspace
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#columnspace">
     Columnspace
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvalues-eigenvectors-and-diagonalization">
     Eigenvalues, Eigenvectors, and Diagonalization
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#possible-issues">
   Possible Issues
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#zero-testing">
     Zero Testing
    </a>
   </li>
  </ul>
 </li>
</ul>

</nav>
              </div>
              
              <div class="toc-item">
                
              </div>
              
            
          </div>
          

          
          
            
          
          <main class="col-12 col-md-9 col-xl-7 py-md-5 pl-md-5 pr-md-4 bd-content" role="main">
              
              <div>
                
  <section id="matrices">
<span id="id1"></span><h1>Matrices<a class="headerlink" href="#matrices" title="Permalink to this headline">¶</a></h1>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">init_printing</span><span class="p">(</span><span class="n">use_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>To make a matrix in SymPy, use the <code class="docutils literal notranslate"><span class="pre">Matrix</span></code> object.  A matrix is constructed
by providing a list of row vectors that make up the matrix.  For example,
to construct the matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[\begin{array}{cc}1 &amp; -1\\3 &amp; 4\\0 &amp; 2\end{array}\right]\end{split}\]</div>
<p>use</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="go">⎡1  -1⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎢3  4 ⎥</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣0  2 ⎦</span>
</pre></div>
</div>
<p>To make it easy to make column vectors, a list of elements is considered to be
a column vector.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="go">⎡1⎤</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎢2⎥</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎣3⎦</span>
</pre></div>
</div>
<p>Matrices are manipulated just like any other object in SymPy or Python.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">*</span><span class="n">N</span>
<span class="go">⎡5⎤</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎣3⎦</span>
</pre></div>
</div>
<p>One important thing to note about SymPy matrices is that, unlike every other
object in SymPy, they are mutable.  This means that they can be modified in
place, as we will see below.  The downside to this is that <code class="docutils literal notranslate"><span class="pre">Matrix</span></code> cannot
be used in places that require immutability, such as inside other SymPy
expressions or as keys to dictionaries.  If you need an immutable version of
<code class="docutils literal notranslate"><span class="pre">Matrix</span></code>, use <code class="docutils literal notranslate"><span class="pre">ImmutableMatrix</span></code>.</p>
<section id="basic-operations">
<h2>Basic Operations<a class="headerlink" href="#basic-operations" title="Permalink to this headline">¶</a></h2>
<p>Here are some basic operations on <code class="docutils literal notranslate"><span class="pre">Matrix</span></code>.</p>
<section id="shape">
<h3>Shape<a class="headerlink" href="#shape" title="Permalink to this headline">¶</a></h3>
<p>To get the shape of a matrix, use <a class="reference internal" href="../modules/codegen.html#sympy.codegen.fnodes.shape" title="sympy.codegen.fnodes.shape"><code class="xref py py-func docutils literal notranslate"><span class="pre">shape()</span></code></a> function.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">shape</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1   2  3⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣-2  0  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shape</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
<span class="go">(2, 3)</span>
</pre></div>
</div>
</section>
<section id="accessing-rows-and-columns">
<h3>Accessing Rows and Columns<a class="headerlink" href="#accessing-rows-and-columns" title="Permalink to this headline">¶</a></h3>
<p>To get an individual row or column of a matrix, use <code class="docutils literal notranslate"><span class="pre">row</span></code> or <code class="docutils literal notranslate"><span class="pre">col</span></code>.  For
example, <code class="docutils literal notranslate"><span class="pre">M.row(0)</span></code> will get the first row. <code class="docutils literal notranslate"><span class="pre">M.col(-1)</span></code> will get the last
column.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">row</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">[1  2  3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">col</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">⎡3⎤</span>
<span class="go">⎢ ⎥</span>
<span class="go">⎣4⎦</span>
</pre></div>
</div>
</section>
<section id="deleting-and-inserting-rows-and-columns">
<h3>Deleting and Inserting Rows and Columns<a class="headerlink" href="#deleting-and-inserting-rows-and-columns" title="Permalink to this headline">¶</a></h3>
<p>To delete a row or column, use <code class="docutils literal notranslate"><span class="pre">row_del</span></code> or <code class="docutils literal notranslate"><span class="pre">col_del</span></code>.  These operations
will modify the Matrix <strong>in place</strong>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">col_del</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡2  3⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣0  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">row_del</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">[2  3]</span>
</pre></div>
</div>
<p>To insert rows or columns, use <code class="docutils literal notranslate"><span class="pre">row_insert</span></code> or <code class="docutils literal notranslate"><span class="pre">col_insert</span></code>.  These
operations <strong>do not</strong> operate in place.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">[2  3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">row_insert</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡2  3⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣0  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">col_insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1   2  3⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣-2  0  4⎦</span>
</pre></div>
</div>
<p>Unless explicitly stated, the methods mentioned below do not operate in
place. In general, a method that does not operate in place will return a new
<code class="docutils literal notranslate"><span class="pre">Matrix</span></code> and a method that does operate in place will return <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</section>
</section>
<section id="basic-methods">
<h2>Basic Methods<a class="headerlink" href="#basic-methods" title="Permalink to this headline">¶</a></h2>
<p>As noted above, simple operations like addition and multiplication are done
just by using <code class="docutils literal notranslate"><span class="pre">+</span></code>, <code class="docutils literal notranslate"><span class="pre">*</span></code>, and <code class="docutils literal notranslate"><span class="pre">**</span></code>.  To find the inverse of a matrix, just
raise it to the <code class="docutils literal notranslate"><span class="pre">-1</span></code> power.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">+</span> <span class="n">N</span>
<span class="go">⎡1   6 ⎤</span>
<span class="go">⎢      ⎥</span>
<span class="go">⎣-2  10⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">*</span><span class="n">N</span>
<span class="go">⎡0  24⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣0  15⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="mi">3</span><span class="o">*</span><span class="n">M</span>
<span class="go">⎡3   9⎤</span>
<span class="go">⎢     ⎥</span>
<span class="go">⎣-6  9⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">**</span><span class="mi">2</span>
<span class="go">⎡-5  12⎤</span>
<span class="go">⎢      ⎥</span>
<span class="go">⎣-8  3 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">**-</span><span class="mi">1</span>
<span class="go">⎡1/3  -1/3⎤</span>
<span class="go">⎢         ⎥</span>
<span class="go">⎣2/9  1/9 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">N</span><span class="o">**-</span><span class="mi">1</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NonInvertibleMatrixError</span>: <span class="n">Matrix det == 0; not invertible.</span>
</pre></div>
</div>
<p>To take the transpose of a Matrix, use <code class="docutils literal notranslate"><span class="pre">T</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1  2  3⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣4  5  6⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">T</span>
<span class="go">⎡1  4⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎢2  5⎥</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣3  6⎦</span>
</pre></div>
</div>
</section>
<section id="matrix-constructors">
<h2>Matrix Constructors<a class="headerlink" href="#matrix-constructors" title="Permalink to this headline">¶</a></h2>
<p>Several constructors exist for creating common matrices.  To create an
identity matrix, use <code class="docutils literal notranslate"><span class="pre">eye</span></code>.  <code class="docutils literal notranslate"><span class="pre">eye(n)</span></code> will create an <span class="math notranslate nohighlight">\(n\times n\)</span> identity matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">⎡1  0  0⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎢0  1  0⎥</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣0  0  1⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eye</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="go">⎡1  0  0  0⎤</span>
<span class="go">⎢          ⎥</span>
<span class="go">⎢0  1  0  0⎥</span>
<span class="go">⎢          ⎥</span>
<span class="go">⎢0  0  1  0⎥</span>
<span class="go">⎢          ⎥</span>
<span class="go">⎣0  0  0  1⎦</span>
</pre></div>
</div>
<p>To create a matrix of all zeros, use <code class="docutils literal notranslate"><span class="pre">zeros</span></code>.  <code class="docutils literal notranslate"><span class="pre">zeros(n,</span> <span class="pre">m)</span></code> creates an
<span class="math notranslate nohighlight">\(n\times m\)</span> matrix of <span class="math notranslate nohighlight">\(0\)</span>s.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">⎡0  0  0⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣0  0  0⎦</span>
</pre></div>
</div>
<p>Similarly, <code class="docutils literal notranslate"><span class="pre">ones</span></code> creates a matrix of ones.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">⎡1  1⎤</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎢1  1⎥</span>
<span class="go">⎢    ⎥</span>
<span class="go">⎣1  1⎦</span>
</pre></div>
</div>
<p>To create diagonal matrices, use <code class="docutils literal notranslate"><span class="pre">diag</span></code>.  The arguments to <code class="docutils literal notranslate"><span class="pre">diag</span></code> can be
either numbers or matrices.  A number is interpreted as a <span class="math notranslate nohighlight">\(1\times 1\)</span>
matrix. The matrices are stacked diagonally.  The remaining elements are
filled with <span class="math notranslate nohighlight">\(0\)</span>s.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">⎡1  0  0⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎢0  2  0⎥</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣0  0  3⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">ones</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">Matrix</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">]))</span>
<span class="go">⎡-1  0  0  0⎤</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   1  1  0⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   1  1  0⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   0  0  5⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   0  0  7⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎣0   0  0  5⎦</span>
</pre></div>
</div>
</section>
<section id="advanced-methods">
<h2>Advanced Methods<a class="headerlink" href="#advanced-methods" title="Permalink to this headline">¶</a></h2>
<section id="determinant">
<h3>Determinant<a class="headerlink" href="#determinant" title="Permalink to this headline">¶</a></h3>
<p>To compute the determinant of a matrix, use <code class="docutils literal notranslate"><span class="pre">det</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1  0   1⎤</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎢2  -1  3⎥</span>
<span class="go">⎢        ⎥</span>
<span class="go">⎣4  3   2⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">det</span><span class="p">()</span>
<span class="go">-1</span>
</pre></div>
</div>
</section>
<section id="rref">
<h3>RREF<a class="headerlink" href="#rref" title="Permalink to this headline">¶</a></h3>
<p>To put a matrix into reduced row echelon form, use <code class="docutils literal notranslate"><span class="pre">rref</span></code>.  <code class="docutils literal notranslate"><span class="pre">rref</span></code> returns
a tuple of two elements. The first is the reduced row echelon form, and the
second is a tuple of indices of the pivot columns.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1   0   1   3 ⎤</span>
<span class="go">⎢              ⎥</span>
<span class="go">⎢2   3   4   7 ⎥</span>
<span class="go">⎢              ⎥</span>
<span class="go">⎣-1  -3  -3  -4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">rref</span><span class="p">()</span>
<span class="go">⎛⎡1  0   1    3 ⎤        ⎞</span>
<span class="go">⎜⎢              ⎥        ⎟</span>
<span class="go">⎜⎢0  1  2/3  1/3⎥, (0, 1)⎟</span>
<span class="go">⎜⎢              ⎥        ⎟</span>
<span class="go">⎝⎣0  0   0    0 ⎦        ⎠</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The first element of the tuple returned by <code class="docutils literal notranslate"><span class="pre">rref</span></code> is of type
<code class="docutils literal notranslate"><span class="pre">Matrix</span></code>. The second is of type <code class="docutils literal notranslate"><span class="pre">tuple</span></code>.</p>
</div>
</section>
<section id="nullspace">
<h3>Nullspace<a class="headerlink" href="#nullspace" title="Permalink to this headline">¶</a></h3>
<p>To find the nullspace of a matrix, use <code class="docutils literal notranslate"><span class="pre">nullspace</span></code>. <code class="docutils literal notranslate"><span class="pre">nullspace</span></code> returns a
<code class="docutils literal notranslate"><span class="pre">list</span></code> of column vectors that span the nullspace of the matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1  2   3  0  0⎤</span>
<span class="go">⎢              ⎥</span>
<span class="go">⎣4  10  0  0  1⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span>
<span class="go">⎡⎡-15⎤  ⎡0⎤  ⎡ 1  ⎤⎤</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎢⎢ 6 ⎥  ⎢0⎥  ⎢-1/2⎥⎥</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎢⎢ 1 ⎥, ⎢0⎥, ⎢ 0  ⎥⎥</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎢⎢ 0 ⎥  ⎢1⎥  ⎢ 0  ⎥⎥</span>
<span class="go">⎢⎢   ⎥  ⎢ ⎥  ⎢    ⎥⎥</span>
<span class="go">⎣⎣ 0 ⎦  ⎣0⎦  ⎣ 1  ⎦⎦</span>
</pre></div>
</div>
</section>
<section id="columnspace">
<h3>Columnspace<a class="headerlink" href="#columnspace" title="Permalink to this headline">¶</a></h3>
<p>To find the columnspace of a matrix, use <code class="docutils literal notranslate"><span class="pre">columnspace</span></code>. <code class="docutils literal notranslate"><span class="pre">columnspace</span></code> returns a
<code class="docutils literal notranslate"><span class="pre">list</span></code> of column vectors that span the columnspace of the matrix.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span> <span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡1  1  2⎤</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎢2  1  3⎥</span>
<span class="go">⎢       ⎥</span>
<span class="go">⎣3  1  4⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">columnspace</span><span class="p">()</span>
<span class="go">⎡⎡1⎤  ⎡1⎤⎤</span>
<span class="go">⎢⎢ ⎥  ⎢ ⎥⎥</span>
<span class="go">⎢⎢2⎥, ⎢1⎥⎥</span>
<span class="go">⎢⎢ ⎥  ⎢ ⎥⎥</span>
<span class="go">⎣⎣3⎦  ⎣1⎦⎦</span>
</pre></div>
</div>
</section>
<section id="eigenvalues-eigenvectors-and-diagonalization">
<h3>Eigenvalues, Eigenvectors, and Diagonalization<a class="headerlink" href="#eigenvalues-eigenvectors-and-diagonalization" title="Permalink to this headline">¶</a></h3>
<p>To find the eigenvalues of a matrix, use <code class="docutils literal notranslate"><span class="pre">eigenvals</span></code>.  <code class="docutils literal notranslate"><span class="pre">eigenvals</span></code>
returns a dictionary of <code class="docutils literal notranslate"><span class="pre">eigenvalue:</span> <span class="pre">algebraic_multiplicity</span></code> pairs (similar to the
output of <a class="reference internal" href="solvers.html#tutorial-roots"><span class="std std-ref">roots</span></a>).</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">3</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span>
<span class="go">⎡3  -2  4   -2⎤</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎢5  3   -3  -2⎥</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎢5  -2  2   -2⎥</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎣5  -2  -3  3 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvals</span><span class="p">()</span>
<span class="go">{-2: 1, 3: 1, 5: 2}</span>
</pre></div>
</div>
<p>This means that <code class="docutils literal notranslate"><span class="pre">M</span></code> has eigenvalues -2, 3, and 5, and that the
eigenvalues -2 and 3 have algebraic multiplicity 1 and that the eigenvalue 5
has algebraic multiplicity 2.</p>
<p>To find the eigenvectors of a matrix, use <code class="docutils literal notranslate"><span class="pre">eigenvects</span></code>.  <code class="docutils literal notranslate"><span class="pre">eigenvects</span></code>
returns a list of tuples of the form <code class="docutils literal notranslate"><span class="pre">(eigenvalue,</span> <span class="pre">algebraic_multiplicity,</span>
<span class="pre">[eigenvectors])</span></code>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">M</span><span class="o">.</span><span class="n">eigenvects</span><span class="p">()</span>
<span class="go">⎡⎛       ⎡⎡0⎤⎤⎞  ⎛      ⎡⎡1⎤⎤⎞  ⎛      ⎡⎡1⎤  ⎡0 ⎤⎤⎞⎤</span>
<span class="go">⎢⎜       ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥  ⎢  ⎥⎥⎟⎥</span>
<span class="go">⎢⎜       ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥  ⎢-1⎥⎥⎟⎥</span>
<span class="go">⎢⎜-2, 1, ⎢⎢ ⎥⎥⎟, ⎜3, 1, ⎢⎢ ⎥⎥⎟, ⎜5, 2, ⎢⎢ ⎥, ⎢  ⎥⎥⎟⎥</span>
<span class="go">⎢⎜       ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥⎥⎟  ⎜      ⎢⎢1⎥  ⎢0 ⎥⎥⎟⎥</span>
<span class="go">⎢⎜       ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥⎥⎟  ⎜      ⎢⎢ ⎥  ⎢  ⎥⎥⎟⎥</span>
<span class="go">⎣⎝       ⎣⎣1⎦⎦⎠  ⎝      ⎣⎣1⎦⎦⎠  ⎝      ⎣⎣0⎦  ⎣1 ⎦⎦⎠⎦</span>
</pre></div>
</div>
<p>This shows us that, for example, the eigenvalue 5 also has geometric
multiplicity 2, because it has two eigenvectors.  Because the algebraic and
geometric multiplicities are the same for all the eigenvalues, <code class="docutils literal notranslate"><span class="pre">M</span></code> is
diagonalizable.</p>
<p>To diagonalize a matrix, use <code class="docutils literal notranslate"><span class="pre">diagonalize</span></code>. <code class="docutils literal notranslate"><span class="pre">diagonalize</span></code> returns a tuple
<span class="math notranslate nohighlight">\((P, D)\)</span>, where <span class="math notranslate nohighlight">\(D\)</span> is diagonal and <span class="math notranslate nohighlight">\(M = PDP^{-1}\)</span>.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="p">,</span> <span class="n">D</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">diagonalize</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span>
<span class="go">⎡0  1  1  0 ⎤</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢1  1  1  -1⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢1  1  1  0 ⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎣1  1  0  1 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span>
<span class="go">⎡-2  0  0  0⎤</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   3  0  0⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎢0   0  5  0⎥</span>
<span class="go">⎢           ⎥</span>
<span class="go">⎣0   0  0  5⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">P</span><span class="o">**-</span><span class="mi">1</span>
<span class="go">⎡3  -2  4   -2⎤</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎢5  3   -3  -2⎥</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎢5  -2  2   -2⎥</span>
<span class="go">⎢             ⎥</span>
<span class="go">⎣5  -2  -3  3 ⎦</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">P</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="n">P</span><span class="o">**-</span><span class="mi">1</span> <span class="o">==</span> <span class="n">M</span>
<span class="go">True</span>
</pre></div>
</div>
<aside class="sidebar">
<p class="sidebar-title">Quick Tip</p>
<p><code class="docutils literal notranslate"><span class="pre">lambda</span></code> is a reserved keyword in Python, so to create a Symbol called
<span class="math notranslate nohighlight">\(\lambda\)</span>, while using the same names for SymPy Symbols and Python
variables, use <code class="docutils literal notranslate"><span class="pre">lamda</span></code> (without the <code class="docutils literal notranslate"><span class="pre">b</span></code>).  It will still pretty print
as <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
</aside>
<p>Note that since <code class="docutils literal notranslate"><span class="pre">eigenvects</span></code> also includes the eigenvalues, you should use
it instead of <code class="docutils literal notranslate"><span class="pre">eigenvals</span></code> if you also want the eigenvectors. However, as
computing the eigenvectors may often be costly, <code class="docutils literal notranslate"><span class="pre">eigenvals</span></code> should be
preferred if you only wish to find the eigenvalues.</p>
<p>If all you want is the characteristic polynomial, use <code class="docutils literal notranslate"><span class="pre">charpoly</span></code>.  This is
more efficient than <code class="docutils literal notranslate"><span class="pre">eigenvals</span></code>, because sometimes symbolic roots can be
expensive to calculate.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lamda</span> <span class="o">=</span> <span class="n">symbols</span><span class="p">(</span><span class="s1">&#39;lamda&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">M</span><span class="o">.</span><span class="n">charpoly</span><span class="p">(</span><span class="n">lamda</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">factor</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">as_expr</span><span class="p">())</span>
<span class="go">       2</span>
<span class="go">(λ - 5) ⋅(λ - 3)⋅(λ + 2)</span>
</pre></div>
</div>
</section>
</section>
<section id="possible-issues">
<h2>Possible Issues<a class="headerlink" href="#possible-issues" title="Permalink to this headline">¶</a></h2>
<section id="zero-testing">
<h3>Zero Testing<a class="headerlink" href="#zero-testing" title="Permalink to this headline">¶</a></h3>
<p>If your matrix operations are failing or returning wrong answers,
the common reasons would likely be from zero testing.
If there is an expression not properly zero-tested,
it can possibly bring issues in finding pivots for gaussian elimination,
or deciding whether the matrix is inversible,
or any high level functions which relies on the prior procedures.</p>
<p>Currently, the SymPy’s default method of zero testing <code class="docutils literal notranslate"><span class="pre">_iszero</span></code> is only
guaranteed to be accurate in some limited domain of numerics and symbols,
and any complicated expressions beyond its decidability are treated as <code class="docutils literal notranslate"><span class="pre">None</span></code>,
which behaves similarly to logical <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<p>The list of methods using zero testing procedures are as follows:</p>
<p><code class="docutils literal notranslate"><span class="pre">echelon_form</span></code> , <code class="docutils literal notranslate"><span class="pre">is_echelon</span></code> , <code class="docutils literal notranslate"><span class="pre">rank</span></code> , <code class="docutils literal notranslate"><span class="pre">rref</span></code> , <code class="docutils literal notranslate"><span class="pre">nullspace</span></code> ,
<code class="docutils literal notranslate"><span class="pre">eigenvects</span></code> , <code class="docutils literal notranslate"><span class="pre">inverse_ADJ</span></code> , <code class="docutils literal notranslate"><span class="pre">inverse_GE</span></code> , <code class="docutils literal notranslate"><span class="pre">inverse_LU</span></code> ,
<code class="docutils literal notranslate"><span class="pre">LUdecomposition</span></code> , <code class="docutils literal notranslate"><span class="pre">LUdecomposition_Simple</span></code> , <code class="docutils literal notranslate"><span class="pre">LUsolve</span></code></p>
<p>They have property <code class="docutils literal notranslate"><span class="pre">iszerofunc</span></code> opened up for user to specify zero testing
method, which can accept any function with single input and boolean output,
while being defaulted with <code class="docutils literal notranslate"><span class="pre">_iszero</span></code>.</p>
<p>Here is an example of solving an issue caused by undertested zero. While the
output for this particular matrix has since been improved, the technique
below is still of interest.
<a class="footnote-reference brackets" href="#zerotestexampleidea-fn" id="id2">1</a> <a class="footnote-reference brackets" href="#zerotestexamplediscovery-fn" id="id3">2</a>
<a class="footnote-reference brackets" href="#zerotestexampleimproved-fn" id="id4">3</a></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s2">&quot;q&quot;</span><span class="p">,</span> <span class="n">positive</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">Matrix</span><span class="p">([</span>
<span class="gp">... </span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">cosh</span><span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span>      <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">q</span><span class="p">),</span>            <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span>      <span class="n">exp</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">cosh</span><span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="mi">3</span><span class="p">),</span>            <span class="mi">1</span><span class="p">],</span>
<span class="gp">... </span><span class="p">[</span>           <span class="mi">1</span><span class="p">,</span>            <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">cosh</span><span class="p">(</span><span class="n">q</span><span class="o">/</span><span class="mi">3</span><span class="p">)]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">nullspace</span><span class="p">()</span> 
<span class="go">[]</span>
</pre></div>
</div>
<p>You can trace down which expression is being underevaluated,
by injecting a custom zero test with warnings enabled.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_iszero</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">is_zero</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Warnings if evaluated into None</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Zero testing of </span><span class="si">{}</span><span class="s2"> evaluated into None&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">result</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">nullspace</span><span class="p">(</span><span class="n">iszerofunc</span><span class="o">=</span><span class="n">my_iszero</span><span class="p">)</span> 
<span class="go">__main__:9: UserWarning: Zero testing of 4*cosh(q/3)**2 - 1 evaluated into None</span>
<span class="go">__main__:9: UserWarning: Zero testing of (-exp(q) - 2*cosh(q/3))*(-2*cosh(q/3) - exp(-q)) - (4*cosh(q/3)**2 - 1)**2 evaluated into None</span>
<span class="go">__main__:9: UserWarning: Zero testing of 2*exp(q)*cosh(q/3) - 16*cosh(q/3)**4 + 12*cosh(q/3)**2 + 2*exp(-q)*cosh(q/3) evaluated into None</span>
<span class="go">__main__:9: UserWarning: Zero testing of -(4*cosh(q/3)**2 - 1)*exp(-q) - 2*cosh(q/3) - exp(-q) evaluated into None</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>In this case,
<code class="docutils literal notranslate"><span class="pre">(-exp(q)</span> <span class="pre">-</span> <span class="pre">2*cosh(q/3))*(-2*cosh(q/3)</span> <span class="pre">-</span> <span class="pre">exp(-q))</span> <span class="pre">-</span> <span class="pre">(4*cosh(q/3)**2</span> <span class="pre">-</span> <span class="pre">1)**2</span></code>
should yield zero, but the zero testing had failed to catch.
possibly meaning that a stronger zero test should be introduced.
For this specific example, rewriting to exponentials and applying simplify would
make zero test stronger for hyperbolics,
while being harmless to other polynomials or transcendental functions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">my_iszero</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">try</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">rewrite</span><span class="p">(</span><span class="n">exp</span><span class="p">)</span><span class="o">.</span><span class="n">simplify</span><span class="p">()</span><span class="o">.</span><span class="n">is_zero</span>
<span class="gp">... </span>    <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">result</span> <span class="o">=</span> <span class="kc">None</span>
<span class="gp">...</span>
<span class="gp">... </span>    <span class="c1"># Warnings if evaluated into None</span>
<span class="gp">... </span>    <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Zero testing of </span><span class="si">{}</span><span class="s2"> evaluated into None&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">result</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="o">.</span><span class="n">nullspace</span><span class="p">(</span><span class="n">iszerofunc</span><span class="o">=</span><span class="n">my_iszero</span><span class="p">)</span> 
<span class="go">__main__:9: UserWarning: Zero testing of -2*cosh(q/3) - exp(-q) evaluated into None</span>
<span class="go">⎡⎡  ⎛   q         ⎛q⎞⎞  -q         2⎛q⎞    ⎤⎤</span>
<span class="go">⎢⎢- ⎜- ℯ  - 2⋅cosh⎜─⎟⎟⋅ℯ   + 4⋅cosh ⎜─⎟ - 1⎥⎥</span>
<span class="go">⎢⎢  ⎝             ⎝3⎠⎠              ⎝3⎠    ⎥⎥</span>
<span class="go">⎢⎢─────────────────────────────────────────⎥⎥</span>
<span class="go">⎢⎢          ⎛      2⎛q⎞    ⎞     ⎛q⎞       ⎥⎥</span>
<span class="go">⎢⎢        2⋅⎜4⋅cosh ⎜─⎟ - 1⎟⋅cosh⎜─⎟       ⎥⎥</span>
<span class="go">⎢⎢          ⎝       ⎝3⎠    ⎠     ⎝3⎠       ⎥⎥</span>
<span class="go">⎢⎢                                         ⎥⎥</span>
<span class="go">⎢⎢           ⎛   q         ⎛q⎞⎞            ⎥⎥</span>
<span class="go">⎢⎢          -⎜- ℯ  - 2⋅cosh⎜─⎟⎟            ⎥⎥</span>
<span class="go">⎢⎢           ⎝             ⎝3⎠⎠            ⎥⎥</span>
<span class="go">⎢⎢          ────────────────────           ⎥⎥</span>
<span class="go">⎢⎢                   2⎛q⎞                  ⎥⎥</span>
<span class="go">⎢⎢             4⋅cosh ⎜─⎟ - 1              ⎥⎥</span>
<span class="go">⎢⎢                    ⎝3⎠                  ⎥⎥</span>
<span class="go">⎢⎢                                         ⎥⎥</span>
<span class="go">⎣⎣                    1                    ⎦⎦</span>
</pre></div>
</div>
<p>You can clearly see <code class="docutils literal notranslate"><span class="pre">nullspace</span></code> returning proper result, after injecting an
alternative zero test.</p>
<p>Note that this approach is only valid for some limited cases of matrices
containing only numerics, hyperbolics, and exponentials.
For other matrices, you should use different method opted for their domains.</p>
<p>Possible suggestions would be either taking advantage of rewriting and
simplifying, with tradeoff of speed <a class="footnote-reference brackets" href="#zerotestsimplifysolution-fn" id="id5">4</a> ,
or using random numeric testing, with tradeoff of accuracy
<a class="footnote-reference brackets" href="#zerotestnumerictestsolution-fn" id="id6">5</a> .</p>
<p>If you wonder why there is no generic algorithm for zero testing that can work
with any symbolic entities,
it’s because of the constant problem stating that zero testing is undecidable
<a class="footnote-reference brackets" href="#constantproblemwikilink-fn" id="id7">6</a> ,
and not only the SymPy, but also other computer algebra systems
<a class="footnote-reference brackets" href="#mathematicazero-fn" id="id8">7</a> <a class="footnote-reference brackets" href="#matlabzero-fn" id="id9">8</a>
would face the same fundamental issue.</p>
<p>However, discovery of any zero test failings can provide some good examples to
improve SymPy,
so if you have encountered one, you can report the issue to
SymPy issue tracker <a class="footnote-reference brackets" href="#sympyissues-fn" id="id10">9</a> to get detailed help from the community.</p>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="zerotestexampleidea-fn"><span class="brackets"><a class="fn-backref" href="#id2">1</a></span></dt>
<dd><p>Inspired by <a class="reference external" href="https://gitter.im/sympy/sympy?at=5b7c3e8ee5b40332abdb206c">https://gitter.im/sympy/sympy?at=5b7c3e8ee5b40332abdb206c</a></p>
</dd>
<dt class="label" id="zerotestexamplediscovery-fn"><span class="brackets"><a class="fn-backref" href="#id3">2</a></span></dt>
<dd><p>Discovered from <a class="reference external" href="https://github.com/sympy/sympy/issues/15141">https://github.com/sympy/sympy/issues/15141</a></p>
</dd>
<dt class="label" id="zerotestexampleimproved-fn"><span class="brackets"><a class="fn-backref" href="#id4">3</a></span></dt>
<dd><p>Improved by <a class="reference external" href="https://github.com/sympy/sympy/pull/19548">https://github.com/sympy/sympy/pull/19548</a></p>
</dd>
<dt class="label" id="zerotestsimplifysolution-fn"><span class="brackets"><a class="fn-backref" href="#id5">4</a></span></dt>
<dd><p>Suggested from <a class="reference external" href="https://github.com/sympy/sympy/issues/10120">https://github.com/sympy/sympy/issues/10120</a></p>
</dd>
<dt class="label" id="zerotestnumerictestsolution-fn"><span class="brackets"><a class="fn-backref" href="#id6">5</a></span></dt>
<dd><p>Suggested from <a class="reference external" href="https://github.com/sympy/sympy/issues/10279">https://github.com/sympy/sympy/issues/10279</a></p>
</dd>
<dt class="label" id="constantproblemwikilink-fn"><span class="brackets"><a class="fn-backref" href="#id7">6</a></span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Constant_problem">https://en.wikipedia.org/wiki/Constant_problem</a></p>
</dd>
<dt class="label" id="mathematicazero-fn"><span class="brackets"><a class="fn-backref" href="#id8">7</a></span></dt>
<dd><p>How mathematica tests zero <a class="reference external" href="https://reference.wolfram.com/language/ref/PossibleZeroQ.html">https://reference.wolfram.com/language/ref/PossibleZeroQ.html</a></p>
</dd>
<dt class="label" id="matlabzero-fn"><span class="brackets"><a class="fn-backref" href="#id9">8</a></span></dt>
<dd><p>How matlab tests zero <a class="reference external" href="https://www.mathworks.com/help/symbolic/mupad_ref/iszero.html">https://www.mathworks.com/help/symbolic/mupad_ref/iszero.html</a></p>
</dd>
<dt class="label" id="sympyissues-fn"><span class="brackets"><a class="fn-backref" href="#id10">9</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/sympy/sympy/issues">https://github.com/sympy/sympy/issues</a></p>
</dd>
</dl>
</section>
</section>
</section>


              </div>
              
              
              <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="solvers.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Solvers</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="manipulation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Advanced Expression Manipulation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
              
          </main>
          

      </div>
    </div>
  
    <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>
  <footer class="footer mt-5 mt-md-0">
  <div class="container">
    
    <div class="footer-item">
      <p class="copyright">
    &copy; Copyright 2022 SymPy Development Team.<br>
</p>
    </div>
    
    <div class="footer-item">
      <p class="sphinx-version">
Created using <a href="http://sphinx-doc.org/">Sphinx</a> 4.4.0.<br>
</p>
    </div>
    
  </div>
</footer>
  </body>
</html>