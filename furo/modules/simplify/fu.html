<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" /><link rel="next" title="Solvers" href="../solvers/index.html" /><link rel="prev" title="Hypergeometric Expansion" href="hyperexpand.html" />

    <link rel="shortcut icon" href="../../_static/sympy-notailtext-favicon.ico"/><meta name="generator" content="sphinx-4.1.2, furo 2021.11.23"/>
        <title>Hongguang Fu’s Trigonometric Simplification - SymPy 1.10.dev documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?digest=7f0192ddeb2adecfbaa87ffbcf67d16358b30bc1" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?digest=0af69da206d614734f649b27d4cdc2dd6c31f41d" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  
  }
  body[data-theme="dark"] {
    --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
  }
  @media (prefers-color-scheme: dark) {
    body:not([data-theme="light"]) {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
  }
</style></head>
  <body>
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" />
      <line x1="4" y1="6" x2="20" y2="6" />
      <line x1="10" y1="12" x2="20" y2="12" />
      <line x1="6" y1="18" x2="20" y2="18" />
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">SymPy 1.10.dev documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand centered" href="../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../_static/sympylogo.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">SymPy 1.10.dev documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../tutorial/index.html">SymPy Tutorial</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/preliminaries.html">Preliminaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/intro.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorial/gotchas.html">Gotchas</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../tutorial/features.html">SymPy Features</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/basic_operations.html">Basic Operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/printing.html">Printing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/simplification.html">Simplification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/calculus.html">Calculus</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/solvers.html">Solvers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/matrices.html">Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../tutorial/manipulation.html">Advanced Expression Manipulation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../guides/index.html">SymPy Guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/getting_started/index.html">Getting Started</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/getting_started/install.html">Installation</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../guides/contributing/index.html">Contributing to SymPy</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/dev-setup.html">Development Environment Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/build-docs.html">Build the Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/debug.html">Debugging</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/docstring.html">SymPy Docstrings Style Guide</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/documentation-style-guide.html">General Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/documentation-style-guide.html#types-of-documentation">Types of Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/documentation-style-guide.html#narrative-documentation-guidelines">Narrative Documentation Guidelines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/documentation-style-guide.html#documentation-using-markdown">Documentation using Markdown</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/documentation-style-guide.html#best-practices-for-writing-documentation">Best Practices for Writing Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../guides/contributing/make-a-contribution.html">Making a Contribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/assumptions.html">Assumptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../guides/booleans.html">Symbolic and fuzzy booleans</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../explanation/index.html">Explanation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../explanation/gotchas.html">Gotchas and Pitfalls</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../explanation/special_topics/index.html">SymPy Special Topics</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/special_topics/finite_diff_derivatives.html">Finite Difference Approximations to Derivatives</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../explanation/special_topics/classification.html">Classification of SymPy objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../reference/index.html">Reference Documentation</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../reference/public/basics/index.html">Basics</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../assumptions/index.html">Assumptions</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../assumptions/ask.html">Ask</a></li>
<li class="toctree-l4"><a class="reference internal" href="../assumptions/assume.html">Assume</a></li>
<li class="toctree-l4"><a class="reference internal" href="../assumptions/refine.html">Refine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../assumptions/predicates.html">Predicates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../calculus/index.html">Calculus</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../combinatorics/index.html">Combinatorics</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/partitions.html">Partitions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/permutations.html">Permutations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/perm_groups.html">Permutation Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/polyhedron.html">Polyhedron</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/prufer.html">Prufer Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/subsets.html">Subsets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/graycode.html">Gray Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/named_groups.html">Named Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/util.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/group_constructs.html">Group constructors</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/testutil.html">Test Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/tensor_can.html">Tensor Canonicalization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/fp_groups.html">Finitely Presented Groups</a></li>
<li class="toctree-l4"><a class="reference internal" href="../combinatorics/pc_groups.html">Polycyclic Groups</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../functions/index.html">Functions</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html">Elementary</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-complexes">sympy.functions.elementary.complexes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-trigonometric">sympy.functions.elementary.trigonometric</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#trigonometric-functions">Trigonometric Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#trigonometric-inverses">Trigonometric Inverses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-hyperbolic">sympy.functions.elementary.hyperbolic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#hyperbolic-functions">Hyperbolic Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#hyperbolic-inverses">Hyperbolic Inverses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-integers">sympy.functions.elementary.integers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-exponential">sympy.functions.elementary.exponential</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-piecewise">sympy.functions.elementary.piecewise</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/elementary.html#sympy-functions-elementary-miscellaneous">sympy.functions.elementary.miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/combinatorial.html">Combinatorial</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/combinatorial.html#enumeration">Enumeration</a></li>
<li class="toctree-l4"><a class="reference internal" href="../functions/special.html">Special</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../integrals/index.html">Integrals</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../integrals/g-functions.html">Computing Integrals using Meijer G-Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integrals/g-functions.html#the-g-function-integration-theorems">The G-Function Integration Theorems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integrals/g-functions.html#the-inverse-laplace-transform-of-a-g-function">The Inverse Laplace Transform of a G-function</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integrals/g-functions.html#implemented-g-function-formulae">Implemented G-Function Formulae</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integrals/g-functions.html#module-sympy.integrals.meijerint">Internal API Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../integrals/integrals.html">Integrals</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../series/index.html">Series</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../series/series.html">Series Expansions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../series/sequences.html">Sequences</a></li>
<li class="toctree-l4"><a class="reference internal" href="../series/fourier.html">Fourier Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../series/formal.html">Formal Power Series</a></li>
<li class="toctree-l4"><a class="reference internal" href="../series/limitseq.html">Limits of Sequences</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="index.html">Simplify</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="simplify.html">Simplify</a></li>
<li class="toctree-l4"><a class="reference internal" href="hyperexpand.html">Hypergeometric Expansion</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Hongguang Fu’s Trigonometric Simplification</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../solvers/index.html">Solvers</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../solvers/diophantine.html">Diophantine</a></li>
<li class="toctree-l4"><a class="reference internal" href="../solvers/inequalities.html">Inequality Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../solvers/ode.html">ODE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../solvers/pde.html">PDE</a></li>
<li class="toctree-l4"><a class="reference internal" href="../solvers/solvers.html">Solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../solvers/solveset.html">Solveset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../abc.html">abc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../algebras.html">Algebras</a></li>
<li class="toctree-l3"><a class="reference internal" href="../concrete.html">Concrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../core.html">Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="../discrete.html">Discrete</a></li>
<li class="toctree-l3"><a class="reference internal" href="../evalf.html">Numerical Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numeric-computation.html">Numeric Computation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../rewriting.html">Term Rewriting</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/codegeneration/index.html">Code Generation</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#code-printers-sympy-printing">Code printers (sympy.printing)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#codegen-sympy-utilities-codegen">Codegen (sympy.utilities.codegen)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#autowrap">Autowrap</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.rewriting">Classes and functions for rewriting expressions (sympy.codegen.rewriting)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.approximations">Tools for simplifying expressions using approximations (sympy.codegen.approximations)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.ast">Classes for abstract syntax trees (sympy.codegen.ast)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.cfunctions">Special C math functions (sympy.codegen.cfunctions)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.cnodes">C specific AST nodes (sympy.codegen.cnodes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.cxxnodes">C++ specific AST nodes (sympy.codegen.cxxnodes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.fnodes">Fortran specific AST nodes (sympy.codegen.fnodes)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.algorithms">Algorithms (sympy.codegen.algorithms)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.pyutils">Python utilities (sympy.codegen.pyutils)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.cutils">C utilities (sympy.codegen.cutils)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../codegen.html#module-sympy.codegen.futils">Fortran utilities (sympy.codegen.futils)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/logic/index.html">Logic</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../logic.html">Logic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../sets.html">Sets</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/matrices/index.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../matrices/index.html">Matrices</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../matrices/matrices.html">Matrices (linear algebra)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/common.html">Common Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/dense.html">Dense Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/sparse.html">Sparse Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/sparsetools.html">Sparse Tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/immutablematrices.html">Immutable Matrices</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/expressions.html">Matrix Expressions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../matrices/normalforms.html">Matrix Normal Forms</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../tensor/index.html">Tensor</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../tensor/array.html">N-dim array</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tensor/indexed.html">Indexed Objects</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tensor/index_methods.html">Methods</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tensor/tensor.html">Tensor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tensor/toperators.html">Tensor Operators</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../vector/index.html">Vector</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../vector/intro.html">Introduction</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/basics.html">Basic Implementation details</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/coordsys.html">More about Coordinate Systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/fields.html">Scalar and Vector Field Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/examples.html">General examples of usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/vector_integration.html">Applications of Vector Integrals</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/api/classes.html">Essential Classes in sympy.vector (docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/api/orienterclasses.html">Orienter classes (docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../vector/api/vectorfunctions.html">Essential Functions in sympy.vector (docstrings)</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/numbertheory/index.html">Number Theory</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../ntheory.html">Ntheory Class Reference</a></li>
<li class="toctree-l3"><a class="reference internal" href="../ntheory.html#ntheory-functions-reference">Ntheory Functions Reference</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/physics/index.html">Physics</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../physics/hydrogen.html">Hydrogen Wavefunctions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physics/matrices.html">Matrices</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physics/paulialgebra.html">Pauli Algebra</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physics/qho_1d.html">Quantum Harmonic Oscillator in 1-D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physics/sho.html">Quantum Harmonic Oscillator in 3-D</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physics/secondquant.html">Second Quantization</a></li>
<li class="toctree-l3"><a class="reference internal" href="../physics/wigner.html">Wigner Symbols</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/units/index.html">Unit systems</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/units/philosophy.html">Philosophy behind unit systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/units/examples.html">Examples</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/units/dimensions.html">Dimensions and dimension systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/units/prefixes.html">Unit prefixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/units/unitsystem.html">Units and unit systems</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/units/quantities.html">Physical quantities</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/hep/index.html">High energy physics</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/vector/index.html">The Physics Vector Module</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/vectors.html">Vector &amp; ReferenceFrame</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/kinematics.html">Vector: Kinematics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/advanced.html">Potential Issues/Advanced Topics/Future Features in Physics/Vector Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/fields.html">Scalar and Vector Field Functionality</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/api/classes.html">Essential Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/api/kinematics.html">Kinematics (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/api/printing.html">Printing (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/api/functions.html">Essential Functions (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/vector/api/fieldfunctions.html">Docstrings for basic field functions</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/mechanics/index.html">Classical Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/masses.html">Masses, Inertias, Particles and Rigid Bodies in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/kane.html">Kane’s Method in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/lagrange.html">Lagrange’s Method in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/symsystem.html">Symbolic Systems in Physics/Mechanics</a></li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../physics/mechanics/linearize.html">Linearization in Physics/Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5"><a class="reference internal" href="../physics/mechanics/examples/lin_pend_nonmin_example.html">Nonminimal Coordinates Pendulum</a></li>
</ul>
</li>
<li class="toctree-l4 has-children"><a class="reference internal" href="../physics/mechanics/examples.html">Examples for Physics/Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l5 has-children"><a class="reference internal" href="../physics/mechanics/examples/rollingdisc_example.html">A rolling disc</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l6"><a class="reference internal" href="../physics/mechanics/examples/rollingdisc_example_kane.html">A rolling disc, with Kane’s method</a></li>
<li class="toctree-l6"><a class="reference internal" href="../physics/mechanics/examples/rollingdisc_example_kane_constraints.html">A rolling disc, with Kane’s method and constraint forces</a></li>
<li class="toctree-l6"><a class="reference internal" href="../physics/mechanics/examples/rollingdisc_example_lagrange.html">A rolling disc using Lagrange’s Method</a></li>
</ul>
</li>
<li class="toctree-l5"><a class="reference internal" href="../physics/mechanics/examples/bicycle_example.html">A bicycle</a></li>
<li class="toctree-l5"><a class="reference internal" href="../physics/mechanics/examples/lin_pend_nonmin_example.html">Nonminimal Coordinates Pendulum</a></li>
<li class="toctree-l5"><a class="reference internal" href="../physics/mechanics/examples/multi_degree_freedom_holonomic_system.html">Multi Degree of Freedom Holonomic System</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/advanced.html">Potential Issues/Advanced Topics/Future Features in Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/reference.html">References for Physics/Mechanics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/autolev_parser.html">Autolev Parser</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/sympy_mechanics_for_autolev_users.html">SymPy Mechanics for Autolev Users</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/part_bod.html">Masses, Inertias &amp; Particles, RigidBodys (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/kane_lagrange.html">Kane’s Method &amp; Lagrange’s Method (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/system.html">SymbolicSystem (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/linearize.html">Linearization (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/expr_manip.html">Expression Manipulation (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/printing.html">Printing (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/body.html">Body (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/mechanics/api/joint.html">Joint (Docstrings)</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/quantum/index.html">Quantum Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-32" name="toctree-checkbox-32" role="switch" type="checkbox"/><label for="toctree-checkbox-32"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/anticommutator.html">Anticommutator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/cg.html">Clebsch-Gordan Coefficients</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/commutator.html">Commutator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/constants.html">Constants</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/dagger.html">Dagger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/innerproduct.html">Inner Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/tensorproduct.html">Tensor Product</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/cartesian.html">Cartesian Operators and States</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/hilbert.html">Hilbert Space</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/operator.html">Operator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/operatorset.html">Operator/State Helper Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/qapply.html">Qapply</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/represent.html">Represent</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/spin.html">Spin</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/state.html">State</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/circuitplot.html">Circuit Plot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/gate.html">Gates</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/grover.html">Grover’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/qft.html">QFT</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/qubit.html">Qubit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/shor.html">Shor’s Algorithm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/quantum/piab.html">Particle in a Box</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/optics/index.html">Optics Module</a><input class="toctree-checkbox" id="toctree-checkbox-33" name="toctree-checkbox-33" role="switch" type="checkbox"/><label for="toctree-checkbox-33"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/optics/gaussopt.html">Gaussian Optics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/optics/medium.html">Medium</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/optics/polarization.html">Polarization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/optics/utils.html">Utilities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/optics/waves.html">Waves</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/control/index.html">Control Module</a><input class="toctree-checkbox" id="toctree-checkbox-34" name="toctree-checkbox-34" role="switch" type="checkbox"/><label for="toctree-checkbox-34"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/control/control.html">Control</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/control/lti.html">Control API</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/control/control_plots.html">Control System Plots</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../physics/continuum_mechanics/index.html">Continuum Mechanics</a><input class="toctree-checkbox" id="toctree-checkbox-35" name="toctree-checkbox-35" role="switch" type="checkbox"/><label for="toctree-checkbox-35"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../physics/continuum_mechanics/beam.html">Beam (Docstrings)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../physics/continuum_mechanics/beam_problems.html">Solving Beam Bending Problems using Singularity Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/utilities/index.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-36" name="toctree-checkbox-36" role="switch" type="checkbox"/><label for="toctree-checkbox-36"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../testing/index.html">Testing</a><input class="toctree-checkbox" id="toctree-checkbox-37" name="toctree-checkbox-37" role="switch" type="checkbox"/><label for="toctree-checkbox-37"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../testing/pytest.html">pytest</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/randtest.html">Randomised Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../testing/runtests.html">Run Tests</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../utilities/index.html">Utilities</a><input class="toctree-checkbox" id="toctree-checkbox-38" name="toctree-checkbox-38" role="switch" type="checkbox"/><label for="toctree-checkbox-38"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../utilities/autowrap.html">Autowrap Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/codegen.html">Codegen</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/decorator.html">Decorator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/enumerative.html">Enumerative</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/iterables.html">Iterables</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/lambdify.html">Lambdify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/memoization.html">Memoization</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/misc.html">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/pkgdata.html">PKGDATA</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/source.html">Source Code Inspection</a></li>
<li class="toctree-l4"><a class="reference internal" href="../utilities/timeutils.html">Timing Utilities</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../interactive.html">Interactive</a></li>
<li class="toctree-l3"><a class="reference internal" href="../parsing.html">Parsing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../printing.html">Printing</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../reference/public/topics/index.html">Topics</a><input class="toctree-checkbox" id="toctree-checkbox-39" name="toctree-checkbox-39" role="switch" type="checkbox"/><label for="toctree-checkbox-39"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../geometry/index.html">Geometry</a><input class="toctree-checkbox" id="toctree-checkbox-40" name="toctree-checkbox-40" role="switch" type="checkbox"/><label for="toctree-checkbox-40"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../geometry/entities.html">Entities</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/utils.html">Utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/points.html">Points</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/lines.html">Lines</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/curves.html">Curves</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/ellipses.html">Ellipses</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/polygons.html">Polygons</a></li>
<li class="toctree-l4"><a class="reference internal" href="../geometry/plane.html">Plane</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../holonomic/index.html">Holonomic</a><input class="toctree-checkbox" id="toctree-checkbox-41" name="toctree-checkbox-41" role="switch" type="checkbox"/><label for="toctree-checkbox-41"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../holonomic/about.html">About Holonomic Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../holonomic/represent.html">Representation of holonomic functions in SymPy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../holonomic/operations.html">Operations on holonomic functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../holonomic/convert.html">Converting other representations to holonomic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../holonomic/uses.html">Uses and Current limitations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../holonomic/internal.html">Internal API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../liealgebras/index.html">Lie Algebra</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../polys/index.html">Polynomial Manipulation</a><input class="toctree-checkbox" id="toctree-checkbox-42" name="toctree-checkbox-42" role="switch" type="checkbox"/><label for="toctree-checkbox-42"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../polys/basics.html">Basic functionality of the module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/wester.html">Examples from Wester’s Article</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/reference.html">Polynomials Manipulation Module Reference</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/agca.html">AGCA - Algebraic Geometry and Commutative Algebra Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/domainsintro.html">Introducing the Domains of the poly module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/domainsref.html">Reference docs for the Poly Domains</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/internals.html">Internals of the Polynomial Manipulation Module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/ringseries.html">Series Manipulation using Polynomials</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/literature.html">Literature</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/solvers.html">Poly solvers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/domainmatrix.html">Introducing the domainmatrix of the poly module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../polys/numberfields.html">Number Fields</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../categories.html">Category Theory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../crypto.html">Cryptography</a></li>
<li class="toctree-l3"><a class="reference internal" href="../diffgeom.html">Differential Geometry</a></li>
<li class="toctree-l3"><a class="reference internal" href="../plotting.html">Plotting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../stats.html">Stats</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../miscellaneous/index.html">Miscellaneous</a><input class="toctree-checkbox" id="toctree-checkbox-43" name="toctree-checkbox-43" role="switch" type="checkbox"/><label for="toctree-checkbox-43"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../aboutus.html">About</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../citing.html">Citing SymPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wiki.html">Wiki</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outreach.html">SymPy Papers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outreach.html#planet-sympy">Planet SymPy</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outreach.html#sympy-logos">SymPy logos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../outreach.html#blogs-news-magazines">Blogs, News, Magazines</a></li>
</ul>
</li>
</ul>

</div>
</div>
      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="hongguang-fu-s-trigonometric-simplification">
<h1>Hongguang Fu’s Trigonometric Simplification<a class="headerlink" href="#hongguang-fu-s-trigonometric-simplification" title="Permalink to this headline">¶</a></h1>
<p>Implementation of the trigsimp algorithm by Fu et al.</p>
<p>The idea behind the Fu algorithm is to use a sequence of rules
that students learn during their pre-calculus courses.
The rules are applied heuristically and it uses a greedy algorithm to
apply multiple rules simultaneously and choose the result with the least
leaf counts.</p>
<p>There are transform rules in which a single rule is applied to the
expression tree. The following are just mnemonic in nature; see the
docstrings for examples.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR0" title="sympy.simplify.fu.TR0"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR0()</span></code></a> - simplify expression</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR1" title="sympy.simplify.fu.TR1"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR1()</span></code></a> - sec-csc to cos-sin</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR2" title="sympy.simplify.fu.TR2"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR2()</span></code></a> - tan-cot to sin-cos ratio</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR2i" title="sympy.simplify.fu.TR2i"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR2i()</span></code></a> - sin-cos ratio to tan</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR3" title="sympy.simplify.fu.TR3"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR3()</span></code></a> - angle canonicalization</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR4" title="sympy.simplify.fu.TR4"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR4()</span></code></a> - functions at special angles</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR5" title="sympy.simplify.fu.TR5"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR5()</span></code></a> - powers of sin to powers of cos</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR6" title="sympy.simplify.fu.TR6"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR6()</span></code></a> - powers of cos to powers of sin</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR7" title="sympy.simplify.fu.TR7"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR7()</span></code></a> - reduce cos power (increase angle)</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR8" title="sympy.simplify.fu.TR8"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR8()</span></code></a> - expand products of sin-cos to sums</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR9" title="sympy.simplify.fu.TR9"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR9()</span></code></a> - contract sums of sin-cos to products</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR10" title="sympy.simplify.fu.TR10"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR10()</span></code></a> - separate sin-cos arguments</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR10i" title="sympy.simplify.fu.TR10i"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR10i()</span></code></a> - collect sin-cos arguments</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR11" title="sympy.simplify.fu.TR11"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR11()</span></code></a> - reduce double angles</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR12" title="sympy.simplify.fu.TR12"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR12()</span></code></a> - separate tan arguments</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR12i" title="sympy.simplify.fu.TR12i"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR12i()</span></code></a> - collect tan arguments</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR13" title="sympy.simplify.fu.TR13"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR13()</span></code></a> - expand product of tan-cot</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TRmorrie" title="sympy.simplify.fu.TRmorrie"><code class="xref py py-func docutils literal notranslate"><span class="pre">TRmorrie()</span></code></a> - prod(cos(x*2**i), (i, 0, k - 1)) -&gt; sin(2**k*x)/(2**k*sin(x))</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR14" title="sympy.simplify.fu.TR14"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR14()</span></code></a> - factored powers of sin or cos to cos or sin power</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR15" title="sympy.simplify.fu.TR15"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR15()</span></code></a> - negative powers of sin to cot power</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR16" title="sympy.simplify.fu.TR16"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR16()</span></code></a> - negative powers of cos to tan power</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR22" title="sympy.simplify.fu.TR22"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR22()</span></code></a> - tan-cot powers to negative powers of sec-csc functions</p></li>
<li><p><a class="reference internal" href="#sympy.simplify.fu.TR111" title="sympy.simplify.fu.TR111"><code class="xref py py-func docutils literal notranslate"><span class="pre">TR111()</span></code></a> - negative sin-cos-tan powers to csc-sec-cot</p></li>
</ul>
<p>There are 4 combination transforms (CTR1 - CTR4) in which a sequence of
transformations are applied and the simplest expression is selected from
a few options.</p>
<p>Finally, there are the 2 rule lists (RL1 and RL2), which apply a
sequence of transformations and combined transformations, and the <code class="docutils literal notranslate"><span class="pre">fu</span></code>
algorithm itself, which applies rules and rule lists and selects the
best expressions. There is also a function <code class="docutils literal notranslate"><span class="pre">L</span></code> which counts the number
of trigonometric functions that appear in the expression.</p>
<p>Other than TR0, re-writing of expressions is not done by the transformations.
e.g. TR10i finds pairs of terms in a sum that are in the form like
<code class="docutils literal notranslate"><span class="pre">cos(x)*cos(y)</span> <span class="pre">+</span> <span class="pre">sin(x)*sin(y)</span></code>. Such expression are targeted in a bottom-up
traversal of the expression, but no manipulation to make them appear is
attempted. For example,</p>
<p>Set-up for examples below:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">fu</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">TR9</span><span class="p">,</span> <span class="n">TR10i</span><span class="p">,</span> <span class="n">TR11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">factor</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">powsimp</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">trig</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">-sin(x)*sin(y)/cos(x) + cos(y)</span>
</pre></div>
</div>
<p>If the expression is put in “normal” form (with a common denominator) then
the transformation is successful:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">_</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span>
<span class="go">cos(x + y)/cos(x)</span>
</pre></div>
</div>
<p>TR11’s behavior is similar. It rewrites double angles as smaller angles but
doesn’t do any simplification of the result.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">a</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">(2*sin(1)*cos(1))**a/cos(1)**a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">powsimp</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">(2*sin(1))**a</span>
</pre></div>
</div>
<p>The temptation is to try make these TR rules “smarter” but that should really
be done at a higher level; the TR rules should try maintain the “do one thing
well” principle.  There is one exception, however. In TR10i and TR9 terms are
recognized even when they are each multiplied by a common factor:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
<span class="go">a*cos(x - y)</span>
</pre></div>
</div>
<p>Factoring with <code class="docutils literal notranslate"><span class="pre">factor_terms</span></code> is used but it is “JIT”-like, being delayed
until it is deemed necessary. Furthermore, if the factoring does not
help with the simplification, it is not retained, so
<code class="docutils literal notranslate"><span class="pre">a*cos(x)*cos(y)</span> <span class="pre">+</span> <span class="pre">a*sin(x)*sin(z)</span></code> does not become a factored
(but unsimplified in the trigonometric sense) expression:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="go">a*sin(x)*sin(z) + a*cos(x)*cos(y)</span>
</pre></div>
</div>
<p>In some cases factoring might be a good idea, but the user is left
to make that decision. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span><span class="o">=</span><span class="p">((</span><span class="mi">15</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">17</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">19</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="mi">25</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">20</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">15</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">14</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="mi">14</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">9</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">12</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span>
<span class="gp">... </span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">18</span><span class="p">))</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">trig</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">expand</span><span class="p">()</span>
</pre></div>
</div>
<p>In the expanded state, there are nearly 1000 trig functions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">L</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">932</span>
</pre></div>
</div>
<p>If the expression where factored first, this would take time but the
resulting expression would be transformed very quickly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">clock</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">t</span><span class="o">=</span><span class="n">time</span><span class="p">();</span> <span class="n">f</span><span class="p">();</span> <span class="k">return</span> <span class="nb">round</span><span class="p">(</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">t</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clock</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">factor</span><span class="p">(</span><span class="n">expr</span><span class="p">))</span>  
<span class="go">0.86</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">clock</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">TR10i</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span>  
<span class="go">0.016</span>
</pre></div>
</div>
<p>If the unexpanded expression is used, the transformation takes longer but
not as long as it took to factor it and then transform it:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">clock</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="n">TR10i</span><span class="p">(</span><span class="n">expr</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>  
<span class="go">0.28</span>
</pre></div>
</div>
<p>So neither expansion nor factoring is used in <code class="docutils literal notranslate"><span class="pre">TR10i</span></code>: if the
expression is already factored (or partially factored) then expansion
with <code class="docutils literal notranslate"><span class="pre">trig=True</span></code> would destroy what is already known and take
longer; if the expression is expanded, factoring may take longer than
simply applying the transformation itself.</p>
<p>Although the algorithms should be canonical, always giving the same
result, they may not yield the best result. This, in general, is
the nature of simplification where searching all possible transformation
paths is very expensive. Here is a simple example. There are 6 terms
in the following sum:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">expr</span> <span class="o">=</span> <span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">+</span>
<span class="gp">... </span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">args</span> <span class="o">=</span> <span class="n">expr</span><span class="o">.</span><span class="n">args</span>
</pre></div>
</div>
<p>Serendipitously, fu gives the best result:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">expr</span><span class="p">)</span>
<span class="go">3*cos(y - z)/2 - cos(2*x + y + z)/2</span>
</pre></div>
</div>
<p>But if different terms were combined, a less-optimal result might be
obtained, requiring some additional work to get better simplification,
but still less than optimal. The following shows an alternative form
of <code class="docutils literal notranslate"><span class="pre">expr</span></code> that resists optimal simplification once a given step
is taken since it leads to a dead end:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span>
<span class="gp">... </span>    <span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">+</span> <span class="n">z</span><span class="p">)</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="go">sin(2*x)*sin(y + z)/2 - cos(x)**2*cos(y + z) + 3*cos(y - z)/2 + cos(y + z)/2</span>
</pre></div>
</div>
<p>Here is a smaller expression that exhibits the same behavior:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">z</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">sin(x)*sin(y + z)*cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">newa</span> <span class="o">=</span> <span class="n">_</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">expr</span> <span class="o">-</span> <span class="n">a</span><span class="p">)</span>  <span class="c1"># this combines two more of the remaining terms</span>
<span class="go">sin(x)**2*cos(y)*cos(z) + sin(y)*sin(z)*cos(x)**2 + cos(y - z)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">_</span> <span class="o">+</span> <span class="n">newa</span><span class="p">)</span> <span class="o">==</span> <span class="n">_</span> <span class="o">+</span> <span class="n">newa</span>  <span class="c1"># but now there is no more simplification</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Without getting lucky or trying all possible pairings of arguments, the
final result may be less than optimal and impossible to find without
better heuristics or brute force trial of all possibilities.</p>
<section id="rules">
<h2>Rules<a class="headerlink" href="#rules" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR0">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR0</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L31-L37"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR0" title="Permalink to this definition">¶</a></dt>
<dd><p>Simplification of rational polynomials, trying to simplify
the expression, e.g. combine things like 3*x + 2*x, etc….</p>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR1">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L40-L61"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR1" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace sec, csc with 1/cos, 1/sin</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR1</span><span class="p">,</span> <span class="n">sec</span><span class="p">,</span> <span class="n">csc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR1</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">csc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sec</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">1/cos(x) + 2/sin(x)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR2">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L64-L91"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR2" title="Permalink to this definition">¶</a></dt>
<dd><p>Replace tan and cot with sin/cos and cos/sin</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">sin(x)/cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2</span><span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">cos(x)/sin(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR2i">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR2i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">half</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L94-L207"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR2i" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>Converts ratios involving sin and cos as follows::</dt><dd><p>sin(x)/cos(x) -&gt; tan(x)
sin(x)/(cos(x) + 1) -&gt; tan(x/2) if half=True</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR2i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">a</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR2i</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">tan(x)</span>
</pre></div>
</div>
<p>Powers of the numerator and denominator are also recognized</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR2i</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">half</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">tan(x/2)**2</span>
</pre></div>
</div>
<p>The transformation does not take place unless assumptions allow
(i.e. the base must be positive or the exponent must be an integer
for both numerator and denominator)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR2i</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="o">/</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="n">a</span><span class="p">)</span>
<span class="go">sin(x)**a/(cos(x) + 1)**a</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR3">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L210-L249"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR3" title="Permalink to this definition">¶</a></dt>
<dd><p>Induced formula: example sin(-a) = -sin(a)</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR3</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="o">*</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span><span class="p">)))</span>
<span class="go">cos(x*(x - y) + y)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-sin(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="mi">30</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">)</span>
<span class="go">-cos(x)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR4">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L252-L276"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR4" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify values of special angles.</p>
<p class="rubric">A=  0   Pi/6        Pi/4        Pi/3        Pi/2</p>
<p>sin(a)  0   1/2         sqrt(2)/2   sqrt(3)/2   1
cos(a)  1   sqrt(3)/2   sqrt(2)/2   1/2         0
tan(a)  0   sqt(3)/3    1           sqrt(3)     –</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">,</span> <span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">):</span>
<span class="gp">... </span>   <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1"> </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">sin</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">tan</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">cot</span><span class="p">(</span><span class="n">s</span><span class="p">)))</span>
<span class="gp">...</span>
<span class="go">1 0 0 zoo</span>
<span class="go">sqrt(3)/2 1/2 sqrt(3)/3 sqrt(3)</span>
<span class="go">sqrt(2)/2 sqrt(2)/2 1 1</span>
<span class="go">1/2 sqrt(3)/2 sqrt(3) sqrt(3)/3</span>
<span class="go">0 1 zoo 0</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR5">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR5</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L343-L361"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR5" title="Permalink to this definition">¶</a></dt>
<dd><p>Replacement of sin**2 with 1 - cos(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR5</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1 - cos(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR5</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># unchanged</span>
<span class="go">sin(x)**(-2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR5</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(1 - cos(x)**2)**2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR6">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L364-L382"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR6" title="Permalink to this definition">¶</a></dt>
<dd><p>Replacement of cos**2 with 1 - sin(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR6</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1 - sin(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR6</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span>  <span class="c1">#unchanged</span>
<span class="go">cos(x)**(-2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR6</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(1 - sin(x)**2)**2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR7">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR7</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L385-L406"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR7" title="Permalink to this definition">¶</a></dt>
<dd><p>Lowering the degree of cos(x)**2.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR7</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">cos(2*x)/2 + 1/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR7</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">cos(2*x)/2 + 3/2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR8">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR8</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L409-L481"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR8" title="Permalink to this definition">¶</a></dt>
<dd><p>Converting products of <code class="docutils literal notranslate"><span class="pre">cos</span></code> and/or <code class="docutils literal notranslate"><span class="pre">sin</span></code> to a sum or
difference of <code class="docutils literal notranslate"><span class="pre">cos</span></code> and or <code class="docutils literal notranslate"><span class="pre">sin</span></code> terms.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR8</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">cos(5)/2 + cos(1)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">sin(5)/2 + sin(1)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">-cos(5)/2 + cos(1)/2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR9">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR9</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L484-L575"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR9" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of <code class="docutils literal notranslate"><span class="pre">cos</span></code> or <code class="docutils literal notranslate"><span class="pre">sin</span></code> terms as a product of <code class="docutils literal notranslate"><span class="pre">cos</span></code> or <code class="docutils literal notranslate"><span class="pre">sin</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">2*cos(1/2)*cos(3/2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cos(1) + 4*sin(3/2)*cos(1/2)</span>
</pre></div>
</div>
<p>If no change is made by TR9, no re-arrangement of the
expression will be made. For example, though factoring
of common term is attempted, if the factored expression
wasn’t changed, the original expression will be returned:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR9</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cos(3) + cos(2)*cos(3)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR10">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR10</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L578-L623"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR10" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate sums in <code class="docutils literal notranslate"><span class="pre">cos</span></code> and <code class="docutils literal notranslate"><span class="pre">sin</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
<span class="go">-sin(a)*sin(b) + cos(a)*cos(b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span>
<span class="go">sin(a)*cos(b) + sin(b)*cos(a)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span> <span class="o">+</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">))</span>
<span class="go">(-sin(a)*sin(b) + cos(a)*cos(b))*sin(c) +     (sin(a)*cos(b) + sin(b)*cos(a))*cos(c)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR10i">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR10i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L626-L755"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR10i" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of products to function of sum.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR10i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">cos(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="p">))</span>
<span class="go">cos(3) + sin(4)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR10i</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>
<span class="go">2*sqrt(2)*x*sin(x + pi/6)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR11">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR11</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L758-L835"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR11" title="Permalink to this definition">¶</a></dt>
<dd><p>Function of double angle to product. The <code class="docutils literal notranslate"><span class="pre">base</span></code> argument can be used
to indicate what is the un-doubled argument, e.g. if 3*pi/7 is the base
then cosine and sine functions with argument 6*pi/7 will be replaced.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR11</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*sin(x)*cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">-sin(x)**2 + cos(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">4*(-sin(x)**2 + cos(x)**2)*sin(x)*cos(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="mi">3</span><span class="p">))</span>
<span class="go">4*(-sin(x/3)**2 + cos(x/3)**2)*sin(x/3)*cos(x/3)</span>
</pre></div>
</div>
<p>If the arguments are simply integers, no change is made
unless a base is provided:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cos(2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">-sin(2)**2 + cos(2)**2</span>
</pre></div>
</div>
<p>There is a subtle issue here in that autosimplification will convert
some higher angles to lower angles</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cos</span><span class="p">(</span><span class="mi">6</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-cos(pi/7) + cos(3*pi/7)</span>
</pre></div>
</div>
<p>The 6*pi/7 angle is now pi/7 but can be targeted with TR11 by supplying
the 3*pi/7 base:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR11</span><span class="p">(</span><span class="n">_</span><span class="p">,</span> <span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span>
<span class="go">-sin(3*pi/7)**2 + cos(3*pi/7)**2 + cos(3*pi/7)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR12">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR12</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L899-L931"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR12" title="Permalink to this definition">¶</a></dt>
<dd><p>Separate sums in <code class="docutils literal notranslate"><span class="pre">tan</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">))</span>
<span class="go">(tan(x) + tan(y))/(-tan(x)*tan(y) + 1)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR12i">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR12i</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L934-L1054"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR12i" title="Permalink to this definition">¶</a></dt>
<dd><p>Combine tan arguments as
(tan(y) + tan(x))/(tan(x)*tan(y) - 1) -&gt; -tan(x + y).</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR12i</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="p">,</span> <span class="n">tb</span><span class="p">,</span> <span class="n">tc</span> <span class="o">=</span> <span class="p">[</span><span class="n">tan</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">((</span><span class="n">ta</span> <span class="o">+</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">tan(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">((</span><span class="n">ta</span> <span class="o">+</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-tan(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">((</span><span class="o">-</span><span class="n">ta</span> <span class="o">-</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">tan(a + b)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="p">(</span><span class="n">ta</span> <span class="o">+</span> <span class="n">tb</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">ta</span><span class="o">*</span><span class="n">tb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="o">*</span><span class="n">ta</span> <span class="o">-</span> <span class="mi">3</span><span class="o">*</span><span class="n">tc</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">ta</span><span class="o">*</span><span class="n">tc</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR12i</span><span class="p">(</span><span class="n">eq</span><span class="o">.</span><span class="n">expand</span><span class="p">())</span>
<span class="go">-3*tan(a + b)*tan(a + c)/(2*(tan(a) + tan(b) - 1))</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR13">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR13</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1057-L1101"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR13" title="Permalink to this definition">¶</a></dt>
<dd><p>Change products of <code class="docutils literal notranslate"><span class="pre">tan</span></code> or <code class="docutils literal notranslate"><span class="pre">cot</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR13</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR13</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">-tan(2)/tan(5) - tan(3)/tan(5) + 1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR13</span><span class="p">(</span><span class="n">cot</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cot</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span>
<span class="go">cot(2)*cot(5) + 1 + cot(3)*cot(5)</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TRmorrie">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TRmorrie</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1104-L1220"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TRmorrie" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns cos(x)*cos(2*x)*…*cos(2**(k-1)*x) -&gt; sin(2**k*x)/(2**k*sin(x))</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TRmorrie</span><span class="p">,</span> <span class="n">TR8</span><span class="p">,</span> <span class="n">TR3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">Mul</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">pi</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">))</span>
<span class="go">sin(4*x)/(4*sin(x))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">Mul</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]))</span>
<span class="go">7*sin(12)*sin(16)*cos(5)*cos(7)*cos(9)/(64*sin(1)*sin(3))</span>
</pre></div>
</div>
<p>Sometimes autosimplification will cause a power to be
not recognized. e.g. in the following, cos(4*pi/7) automatically
simplifies to -cos(3*pi/7) so only 2 of the 3 terms are
recognized:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">7</span><span class="p">))</span>
<span class="go">-sin(3*pi/7)*cos(3*pi/7)/(4*sin(pi/7))</span>
</pre></div>
</div>
<p>A touch by TR8 resolves the expression to a Rational</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">-1/8</span>
</pre></div>
</div>
<p>In this case, if eq is unsimplified, the answer is obtained
directly:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>But if angles are made canonical with TR3 then the answer
is not simplified without further work:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR3</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">sin(pi/18)*cos(pi/9)*cos(2*pi/9)/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRmorrie</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">sin(pi/18)*sin(4*pi/9)/(8*sin(pi/9))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">cos(7*pi/18)/(16*sin(pi/9))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR3</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>The original expression would have resolve to 1/16 directly with TR8,
however:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">TR8</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r752"><span class="brackets"><a class="fn-backref" href="#id1">R752</a></span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/Morrie%27s_law">https://en.wikipedia.org/wiki/Morrie%27s_law</a></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR14">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR14</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1223-L1341"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR14" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert factored powers of sin and cos identities into simpler
expressions.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR14</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR14</span><span class="p">((</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-sin(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR14</span><span class="p">((</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-cos(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p1</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p2</span> <span class="o">=</span> <span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR14</span><span class="p">(</span><span class="n">p1</span><span class="o">*</span><span class="n">p2</span><span class="o">*</span><span class="n">p3</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
<span class="go">-18*(x - 1)*sin(x)**2*sin(y)**4</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR15">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR15</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1344-L1374"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR15" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert sin(x)**-2 to 1 + cot(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR15</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR15</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-cot(x)**2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR16">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR16</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1377-L1407"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR16" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert cos(x)**-2 to 1 + tan(x)**2.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR16</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">-tan(x)**2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR111">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR111</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1410-L1439"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR111" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert f(x)**-i to g(x)**i where either <code class="docutils literal notranslate"><span class="pre">i</span></code> is an integer
or the base is positive and f, g are: tan, cot; sin, csc; or cos, sec.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR111</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">tan</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR111</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">1 - cot(x)**2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TR22">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TR22</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pow</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1442-L1468"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TR22" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert tan(x)**2 to sec(x)**2 - 1 and cot(x)**2 to csc(x)**2 - 1.</p>
<p>See _TR56 docstring for advanced use of <code class="docutils literal notranslate"><span class="pre">max</span></code> and <code class="docutils literal notranslate"><span class="pre">pow</span></code>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TR22</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">tan</span><span class="p">,</span> <span class="n">cot</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR22</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sec(x)**2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TR22</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">cot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="go">csc(x)**2</span>
</pre></div>
</div>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.TRpower">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">TRpower</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rv</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1471-L1514"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.TRpower" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert sin(x)**n and cos(x)**n with positive n to sums.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">TRpower</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRpower</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span>
<span class="go">-15*cos(2*x)/32 + 3*cos(4*x)/16 - cos(6*x)/32 + 5/16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">TRpower</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">(3*sin(x)/4 - sin(3*x)/4)*(cos(4*x)/2 + cos(8*x)/8 + 3/8)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r753"><span class="brackets"><a class="fn-backref" href="#id2">R753</a></span></dt>
<dd><p><a class="reference external" href="https://en.wikipedia.org/wiki/List_of_trigonometric_identities#Power-reduction_formulae">https://en.wikipedia.org/wiki/List_of_trigonometric_identities#Power-reduction_formulae</a></p>
</dd>
</dl>
</dd></dl>
<dl class="py function">
<dt class="sig sig-object py" id="sympy.simplify.fu.fu">
<span class="sig-prename descclassname"><span class="pre">sympy.simplify.fu.</span></span><span class="sig-name descname"><span class="pre">fu</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">rv</span></em>, <em class="sig-param"><span class="pre">measure=&lt;function</span> <span class="pre">&lt;lambda&gt;&gt;</span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/sympy/sympy/blob/0a5f673ad65c7c19393e88e01017364256c7302f/sympy/simplify/fu.py#L1569-L1657"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sympy.simplify.fu.fu" title="Permalink to this definition">¶</a></dt>
<dd><p>Attempt to simplify expression by using transformation rules given
in the algorithm by Fu et al.</p>
<p><a class="reference internal" href="#sympy.simplify.fu.fu" title="sympy.simplify.fu.fu"><code class="xref py py-func docutils literal notranslate"><span class="pre">fu()</span></code></a> will try to minimize the objective function <code class="docutils literal notranslate"><span class="pre">measure</span></code>.
By default this first minimizes the number of trig terms and then minimizes
the number of total operations.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.simplify.fu</span> <span class="kn">import</span> <span class="n">fu</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="kn">import</span> <span class="n">cos</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">tan</span><span class="p">,</span> <span class="n">pi</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">sqrt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.abc</span> <span class="kn">import</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">6</span><span class="p">))</span>
<span class="go">3/2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="go">2*sqrt(2)*sin(x + pi/3)</span>
</pre></div>
</div>
<p>CTR1 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">eq</span> <span class="o">=</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">eq</span><span class="p">)</span>
<span class="go">cos(x)**4 - 2*cos(y)**2 + 2</span>
</pre></div>
</div>
<p>CTR2 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">S</span><span class="o">.</span><span class="n">Half</span> <span class="o">-</span> <span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sin(x)**2</span>
</pre></div>
</div>
<p>CTR3 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">-</span> <span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">))</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">+</span> <span class="n">cos</span><span class="p">(</span><span class="n">b</span><span class="p">)))</span>
<span class="go">sqrt(2)*sin(a + b + pi/4)</span>
</pre></div>
</div>
<p>CTR4 example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="go">sin(x + pi/3)</span>
</pre></div>
</div>
<p>Example 1</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="o">-</span><span class="n">sin</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span>
<span class="go">-cos(x)**2 + cos(y)**2</span>
</pre></div>
</div>
<p>Example 2</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
<span class="go">sin(pi/18)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">cos</span><span class="p">(</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">)</span><span class="o">*</span><span class="n">cos</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">9</span><span class="p">))</span>
<span class="go">1/16</span>
</pre></div>
</div>
<p>Example 3</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">tan</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">+</span><span class="n">tan</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">-</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">5</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">)</span><span class="o">*</span><span class="n">tan</span><span class="p">(</span><span class="mi">7</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="p">))</span>
<span class="go">-sqrt(3)</span>
</pre></div>
</div>
<p>Objective function example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>  <span class="c1"># default objective function</span>
<span class="go">tan(x)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fu</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">/</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">measure</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="o">-</span><span class="n">x</span><span class="o">.</span><span class="n">count_ops</span><span class="p">())</span> <span class="c1"># maximize op count</span>
<span class="go">sin(x)/cos(x)</span>
</pre></div>
</div>
<p class="rubric">References</p>
<dl class="citation">
<dt class="label" id="r754"><span class="brackets"><a class="fn-backref" href="#id3">R754</a></span></dt>
<dd><p><a class="reference external" href="https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.657.2478&amp;rep=rep1&amp;type=pdf">https://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.657.2478&amp;rep=rep1&amp;type=pdf</a></p>
</dd>
</dl>
</dd></dl>
</section>
<section id="notes">
<h2>Notes<a class="headerlink" href="#notes" title="Permalink to this headline">¶</a></h2>
<p>This work was started by Dimitar Vlahovski at the Technological School
“Electronic systems” (30.11.2011).</p>
<p>Beyond TR13, other rules are not from the original paper, but extended
in SymPy.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id4"><span class="brackets">1</span></dt>
<dd><p>Fu, Hongguang, Xiuqin Zhong, and Zhenbing Zeng.
“Automated and readable simplification of trigonometric expressions.”
Mathematical and computer modelling 44.11 (2006): 1169-1177.
<a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.657.2478&amp;rep=rep1&amp;type=pdf">http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.657.2478&amp;rep=rep1&amp;type=pdf</a></p>
</dd>
<dt class="label" id="id5"><span class="brackets">2</span></dt>
<dd><p>A formula sheet for trigonometric functions.
<a class="reference external" href="http://www.sosmath.com/trig/Trig5/trig5/pdf/pdf.html">http://www.sosmath.com/trig/Trig5/trig5/pdf/pdf.html</a></p>
</dd>
</dl>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../solvers/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Solvers</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="hyperexpand.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Hypergeometric Expansion</div>
                
              </div>
            </a>
        </div>

        <div class="related-information">
              Copyright &#169; 2022 SymPy Development Team |
            Last updated on Jan 14, 2022. |
          Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
          <a href="https://github.com/pradyunsg/furo">Furo theme</a>.
            | <a class="muted-link" href="../../_sources/modules/simplify/fu.rst.txt"
               rel="nofollow">
              Show Source
            </a>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Hongguang Fu’s Trigonometric Simplification</a><ul>
<li><a class="reference internal" href="#rules">Rules</a></li>
<li><a class="reference internal" href="#notes">Notes</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/scripts/furo.js"></script>
    </body>
</html>